using System.Net.Http;
using Nop.Core.Domain.Catalog;
using System.Collections.Generic;
using System.Web.Script.Serialization;

 private ProductRespose GetProductsFromAPI()
        {
            ProductRespose productRespose = new ProductRespose();            
            var client = new HttpClient();
            HttpResponseMessage response = client.GetAsync("https://shopfast.net/sf_api/service.svc/json/getproducts").Result;
            if (response.IsSuccessStatusCode)
            {
                var productsString = response.Content.ReadAsStringAsync().Result;
                JavaScriptSerializer js = new JavaScriptSerializer();
                productRespose = js.Deserialize<ProductRespose>(productsString);

                // Temparary code to filter packages. Here need to filter "IsPackage".
                List<int> ids = new List<int>();
                ids.Add(112); // BASIC
                ids.Add(113); // STANDARD
                ids.Add(114); // PROFESSIONAL
                ids.Add(115); // PREMIUM
                productRespose.GetProductsResult = productRespose.GetProductsResult.Where(p => ids.Contains(p.Id)).OrderBy(p =>p.Id).ToList();                
            }
            return productRespose;
        }
        
        
        
        
        
        
        
        public class ProductRespose
    {
        public ProductRespose()
        {
            GetProductsResult = new List<Product>();
        }
        public List<Product> GetProductsResult { get; set; }
    }
